<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SedSat3: /home/arash/Projects/SedSat3/src/elemental_profile.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">SedSat3<span id="projectnumber">&#160;1.1.3</span>
   </div>
   <div id="projectbrief">Sediment Source Apportionment Tool - Advanced statistical methods for environmental pollution research</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('_2home_2arash_2Projects_2SedSat3_2src_2elemental_profile_8cpp-example.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">/home/arash/Projects/SedSat3/src/elemental_profile.cpp</div></div>
</div><!--header-->
<div class="contents">
<p>Create profile containing only elements included in analysis.</p>
<p>Create profile containing only elements included in analysisFilters the profile based on <a class="el" href="structelement__information.html" title="Metadata describing an element&#39;s role and properties in analysis.">element_information</a> metadata, keeping only elements that should be included in statistical analysis. Excludes:</p><ul>
<li>Elements with include_in_analysis = false</li>
<li>Elements with role = do_not_include</li>
<li>Particle size indicators (role = particle_size)</li>
<li>Organic carbon measurements (role = organic_carbon)</li>
</ul>
<p>The marked status of elements is preserved in the filtered profile.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">element_info</td><td>Pointer to element metadata map (nullptr to include all) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>New profile containing only analysis-appropriate elements</dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd>If element_info == nullptr: returns copy of entire profile </dd>
<dd>
If element_info != nullptr: returns filtered subset </dd>
<dd>
Marked status preserved for included elements </dd>
<dd>
IsIncludedInAnalysis() state copied to output</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Original profile is unchanged (const method)</dd></dl>
<div class="fragment"><div class="line"><a id="_a0" name="_a0"></a><a class="code hl_class" href="classElemental__Profile.html">Elemental_Profile</a> full_profile;</div>
<div class="line">full_profile.<a id="a1" name="a1"></a><a class="code hl_function" href="classElemental__Profile.html#abd371be1a17109dbdb8517a29de516a3">AppendElement</a>(<span class="stringliteral">&quot;Al&quot;</span>, 8.5);</div>
<div class="line">full_profile.<a class="code hl_function" href="classElemental__Profile.html#abd371be1a17109dbdb8517a29de516a3">AppendElement</a>(<span class="stringliteral">&quot;OC&quot;</span>, 2.5);  <span class="comment">// Organic carbon</span></div>
<div class="line">full_profile.<a class="code hl_function" href="classElemental__Profile.html#abd371be1a17109dbdb8517a29de516a3">AppendElement</a>(<span class="stringliteral">&quot;D50&quot;</span>, 125); <span class="comment">// Particle size</span></div>
<div class="line"> </div>
<div class="line">map&lt;string, element_information&gt; info;</div>
<div class="line">info[<span class="stringliteral">&quot;Al&quot;</span>].Role = <a id="a2" name="a2"></a><a class="code hl_enumvalue" href="structelement__information.html#a927baa115e71066b2964052d16cc474ca8e2dcfd7e7e24b1ca76c1193f645902b">element_information::role::element</a>;</div>
<div class="line">info[<span class="stringliteral">&quot;Al&quot;</span>].include_in_analysis = <span class="keyword">true</span>;</div>
<div class="line">info[<span class="stringliteral">&quot;OC&quot;</span>].Role = <a id="a3" name="a3"></a><a class="code hl_enumvalue" href="structelement__information.html#a927baa115e71066b2964052d16cc474cad504cad7691c7cb1144d2d226edf6f94">element_information::role::organic_carbon</a>;</div>
<div class="line">info[<span class="stringliteral">&quot;D50&quot;</span>].Role = <a id="a4" name="a4"></a><a class="code hl_enumvalue" href="structelement__information.html#a927baa115e71066b2964052d16cc474cae44ba3cbb5cd522611b75a74e6a4ba8b">element_information::role::particle_size</a>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Get only analysis elements</span></div>
<div class="line"><a class="code hl_class" href="classElemental__Profile.html">Elemental_Profile</a> analysis = full_profile.<a id="a5" name="a5"></a><a class="code hl_function" href="classElemental__Profile.html#a02d917a6cfb217a12d2015ff4460d780">CreateAnalysisProfile</a>(&amp;info);</div>
<div class="line"><span class="comment">// analysis contains only &quot;Al&quot;, not &quot;OC&quot; or &quot;D50&quot;</span></div>
<div class="ttc" id="aclassElemental__Profile_html"><div class="ttname"><a href="classElemental__Profile.html">Elemental_Profile</a></div><div class="ttdoc">Container for elemental concentration data of a single sediment sample.</div><div class="ttdef"><b>Definition</b> <a href="elemental__profile_8h_source.html#l00113">elemental_profile.h:114</a></div></div>
<div class="ttc" id="aclassElemental__Profile_html_a02d917a6cfb217a12d2015ff4460d780"><div class="ttname"><a href="classElemental__Profile.html#a02d917a6cfb217a12d2015ff4460d780">Elemental_Profile::CreateAnalysisProfile</a></div><div class="ttdeci">Elemental_Profile CreateAnalysisProfile(const map&lt; string, element_information &gt; *elementinfo=nullptr) const</div><div class="ttdoc">Create profile with only analyzed elements.</div><div class="ttdef"><b>Definition</b> <a href="elemental__profile_8cpp_source.html#l00145">elemental_profile.cpp:145</a></div></div>
<div class="ttc" id="aclassElemental__Profile_html_abd371be1a17109dbdb8517a29de516a3"><div class="ttname"><a href="classElemental__Profile.html#abd371be1a17109dbdb8517a29de516a3">Elemental_Profile::AppendElement</a></div><div class="ttdeci">bool AppendElement(const string &amp;name, double val=0.0)</div><div class="ttdoc">Add new element to profile.</div><div class="ttdef"><b>Definition</b> <a href="elemental__profile_8cpp_source.html#l00552">elemental_profile.cpp:552</a></div></div>
<div class="ttc" id="astructelement__information_html_a927baa115e71066b2964052d16cc474ca8e2dcfd7e7e24b1ca76c1193f645902b"><div class="ttname"><a href="structelement__information.html#a927baa115e71066b2964052d16cc474ca8e2dcfd7e7e24b1ca76c1193f645902b">element_information::role::element</a></div><div class="ttdeci">@ element</div><div class="ttdoc">Standard chemical element concentration.</div></div>
<div class="ttc" id="astructelement__information_html_a927baa115e71066b2964052d16cc474cad504cad7691c7cb1144d2d226edf6f94"><div class="ttname"><a href="structelement__information.html#a927baa115e71066b2964052d16cc474cad504cad7691c7cb1144d2d226edf6f94">element_information::role::organic_carbon</a></div><div class="ttdeci">@ organic_carbon</div><div class="ttdoc">Organic carbon content.</div></div>
<div class="ttc" id="astructelement__information_html_a927baa115e71066b2964052d16cc474cae44ba3cbb5cd522611b75a74e6a4ba8b"><div class="ttname"><a href="structelement__information.html#a927baa115e71066b2964052d16cc474cae44ba3cbb5cd522611b75a74e6a4ba8b">element_information::role::particle_size</a></div><div class="ttdeci">@ particle_size</div><div class="ttdoc">Particle size distribution parameter.</div></div>
</div><!-- fragment --><div class="fragment"><div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="elemental__profile_8h.html">elemental_profile.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;Utilities.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;QStringList&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;QFile&gt;</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">// =============================================================================</span></div>
<div class="line"><span class="comment">// CONSTRUCTION AND ASSIGNMENT</span></div>
<div class="line"><span class="comment">// =============================================================================</span></div>
<div class="line"> </div>
<div class="line"><a id="a6" name="a6"></a><a class="code hl_function" href="classElemental__Profile.html#ac74d62dcf559e0bc86414ee7b24bdc2a">Elemental_Profile::Elemental_Profile</a>()</div>
<div class="line">    : map&lt;<a id="a7" name="a7"></a><a class="code hl_enumvalue" href="selectsampledelegate_8h.html#acfe2faf5163390c1dcc12b16ac4b97b3ab45cffe084dd3d20d928bee85e7b0f21">string</a>, double&gt;(),</div>
<div class="line">    <a id="_a8" name="_a8"></a><a class="code hl_class" href="classInterface.html">Interface</a>(),</div>
<div class="line">    included_in_analysis_(true),</div>
<div class="line">    marked_elements_()</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// All initialization done in initializer list</span></div>
<div class="line">    <span class="comment">// Empty body is fine - demonstrates proper C++ style</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="classElemental__Profile.html#ac74d62dcf559e0bc86414ee7b24bdc2a">Elemental_Profile::Elemental_Profile</a>(<span class="keyword">const</span> <a class="code hl_class" href="classElemental__Profile.html">Elemental_Profile</a>&amp; other)</div>
<div class="line">    : map&lt;<a class="code hl_enumvalue" href="selectsampledelegate_8h.html#acfe2faf5163390c1dcc12b16ac4b97b3ab45cffe084dd3d20d928bee85e7b0f21">string</a>, double&gt;(other),  <span class="comment">// Copy base class (element concentrations)</span></div>
<div class="line">    <a class="code hl_class" href="classInterface.html">Interface</a>(other),              <span class="comment">// Copy Interface base class</span></div>
<div class="line">    included_in_analysis_(other.included_in_analysis_),</div>
<div class="line">    marked_elements_(other.marked_elements_)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// All copying done in initializer list - efficient and exception-safe</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">/*/</span></div>
<div class="line"><span class="comment">*@brief Copy assignment operator</span></div>
<div class="line"><span class="comment">*</span></div>
<div class="line"><span class="comment">* Assigns the contents of another profile to this one, replacing all</span></div>
<div class="line"><span class="comment">* existing data.Handles self - assignment safely.</span></div>
<div class="line"><span class="comment">*</span></div>
<div class="line"><span class="comment">*@param other Profile to assign from</span></div>
<div class="line"><span class="comment">* @return Reference to * this for chaining(e.g., a = b = c)</span></div>
<div class="line"><span class="comment">*</span></div>
<div class="line"><span class="comment">* @post* this contains copy of other&#39;s data</span></div>
<div class="line"><span class="comment">* @post Previous contents of * this are replaced</span></div>
<div class="line"><span class="comment">* @post Self - assignment(a = a) is safe</span></div>
<div class="line"><span class="comment">*</span></div>
<div class="line"><span class="comment">*@note Assignment order is important : Interface first, then members,</span></div>
<div class="line"><span class="comment">* then base class to ensure proper cleanup if exceptions occur</span></div>
<div class="line"><span class="comment">*/</span></div>
<div class="line"><a class="code hl_class" href="classElemental__Profile.html">Elemental_Profile</a> &amp; <a id="a9" name="a9"></a><a class="code hl_function" href="classElemental__Profile.html#a0081cfc8b373ed0f6111d866361181e8">Elemental_Profile::operator=</a>(<span class="keyword">const</span> <a class="code hl_class" href="classElemental__Profile.html">Elemental_Profile</a> &amp; other)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Check for self-assignment (important for performance and correctness)</span></div>
<div class="line">    <span class="keywordflow">if</span> (<span class="keyword">this</span> == &amp;other) {</div>
<div class="line">        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Assign in proper order:</span></div>
<div class="line">    <span class="comment">// 1. Interface base class</span></div>
<div class="line">    <a id="a10" name="a10"></a><a class="code hl_function" href="classInterface.html#a46a0a0162fc808dd547bc10cf24224ee">Interface::operator=</a>(other);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// 2. Member variables</span></div>
<div class="line">    <a id="a11" name="a11"></a><a class="code hl_variable" href="classElemental__Profile.html#a4bdadf68530b434fb7be463ac65d1f3a">included_in_analysis_</a> = other.<a class="code hl_variable" href="classElemental__Profile.html#a4bdadf68530b434fb7be463ac65d1f3a">included_in_analysis_</a>;</div>
<div class="line">    <a id="a12" name="a12"></a><a class="code hl_variable" href="classElemental__Profile.html#a20ba46ac0b29779bb16b8ce761b6c764">marked_elements_</a> = other.<a class="code hl_variable" href="classElemental__Profile.html#a20ba46ac0b29779bb16b8ce761b6c764">marked_elements_</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// 3. map base class (element concentrations)</span></div>
<div class="line">    <span class="comment">//    Done last because it might throw, and we want other data copied first</span></div>
<div class="line">    map&lt;string, double&gt;::operator=(other);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_class" href="classElemental__Profile.html">Elemental_Profile</a> <a class="code hl_function" href="classElemental__Profile.html#a02d917a6cfb217a12d2015ff4460d780">Elemental_Profile::CreateAnalysisProfile</a>(</div>
<div class="line">    <span class="keyword">const</span> map&lt;string, element_information&gt;* element_info)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">    <span class="comment">// If no metadata provided, return complete copy</span></div>
<div class="line">    <span class="keywordflow">if</span> (element_info == <span class="keyword">nullptr</span>) {</div>
<div class="line">        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create filtered profile</span></div>
<div class="line">    <a class="code hl_class" href="classElemental__Profile.html">Elemental_Profile</a> filtered_profile;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Copy analysis inclusion flag</span></div>
<div class="line">    filtered_profile.<a class="code hl_variable" href="classElemental__Profile.html#a4bdadf68530b434fb7be463ac65d1f3a">included_in_analysis_</a> = this-&gt;<a class="code hl_variable" href="classElemental__Profile.html#a4bdadf68530b434fb7be463ac65d1f3a">included_in_analysis_</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Iterate through all elements in current profile</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; element_entry : *this) {</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; element_name = element_entry.first;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> concentration = element_entry.second;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Check if element exists in metadata</span></div>
<div class="line">        <span class="keyword">auto</span> info_iter = element_info-&gt;find(element_name);</div>
<div class="line">        <span class="keywordflow">if</span> (info_iter == element_info-&gt;end()) {</div>
<div class="line">            <span class="comment">// Element not in metadata - skip it</span></div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">const</span> <a id="_a13" name="_a13"></a><a class="code hl_struct" href="structelement__information.html">element_information</a>&amp; info = info_iter-&gt;second;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Apply inclusion criteria</span></div>
<div class="line">        <span class="keywordtype">bool</span> should_include = info.<a id="a14" name="a14"></a><a class="code hl_variable" href="structelement__information.html#ac50ec2cd0b5510b23e917db405b2a62d">include_in_analysis</a> &amp;&amp;</div>
<div class="line">            info.<a id="a15" name="a15"></a><a class="code hl_variable" href="structelement__information.html#a5f9e4723fe2c080ca91b31a8f697dd4e">Role</a> != <a id="a16" name="a16"></a><a class="code hl_enumvalue" href="structelement__information.html#a927baa115e71066b2964052d16cc474caea679c8b8d3e2f3ce01d0409a42f68f2">element_information::role::do_not_include</a> &amp;&amp;</div>
<div class="line">            info.<a class="code hl_variable" href="structelement__information.html#a5f9e4723fe2c080ca91b31a8f697dd4e">Role</a> != <a class="code hl_enumvalue" href="structelement__information.html#a927baa115e71066b2964052d16cc474cae44ba3cbb5cd522611b75a74e6a4ba8b">element_information::role::particle_size</a> &amp;&amp;</div>
<div class="line">            info.<a class="code hl_variable" href="structelement__information.html#a5f9e4723fe2c080ca91b31a8f697dd4e">Role</a> != <a class="code hl_enumvalue" href="structelement__information.html#a927baa115e71066b2964052d16cc474cad504cad7691c7cb1144d2d226edf6f94">element_information::role::organic_carbon</a>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (should_include) {</div>
<div class="line">            <span class="comment">// Add element to filtered profile</span></div>
<div class="line">            filtered_profile[element_name] = concentration;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// Preserve marked status if element was marked</span></div>
<div class="line">            <span class="keyword">auto</span> marked_iter = <a class="code hl_variable" href="classElemental__Profile.html#a20ba46ac0b29779bb16b8ce761b6c764">marked_elements_</a>.find(element_name);</div>
<div class="line">            <span class="keywordflow">if</span> (marked_iter != <a class="code hl_variable" href="classElemental__Profile.html#a20ba46ac0b29779bb16b8ce761b6c764">marked_elements_</a>.end() &amp;&amp; marked_iter-&gt;second) {</div>
<div class="line">                filtered_profile.<a class="code hl_variable" href="classElemental__Profile.html#a20ba46ac0b29779bb16b8ce761b6c764">marked_elements_</a>[element_name] = <span class="keyword">true</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> filtered_profile;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_class" href="classElemental__Profile.html">Elemental_Profile</a> <a id="a17" name="a17"></a><a class="code hl_function" href="classElemental__Profile.html#ab22dbed07fdb56b97cf9bccab22545cc">Elemental_Profile::CreateCorrectedProfile</a>(</div>
<div class="line">    <span class="keywordtype">bool</span> exclude_elements,</div>
<div class="line">    <span class="keywordtype">bool</span> apply_corrections,</div>
<div class="line">    <span class="keyword">const</span> vector&lt;double&gt;&amp; reference_om_size,</div>
<div class="line">    <span class="keyword">const</span> <a id="_a18" name="_a18"></a><a class="code hl_class" href="classMultipleLinearRegressionSet.html">MultipleLinearRegressionSet</a>* regression_models,</div>
<div class="line">    <span class="keyword">const</span> map&lt;string, element_information&gt;* element_info)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">    <span class="comment">// Start with current profile</span></div>
<div class="line">    <a class="code hl_class" href="classElemental__Profile.html">Elemental_Profile</a> result = *<span class="keyword">this</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Step 1: Apply OM/size corrections if requested</span></div>
<div class="line">    <span class="keywordflow">if</span> (apply_corrections) {</div>
<div class="line">        <span class="keywordflow">if</span> (regression_models == <span class="keyword">nullptr</span>) {</div>
<div class="line">            <span class="comment">// Log warning or throw exception in production code</span></div>
<div class="line">            std::cerr &lt;&lt; <span class="stringliteral">&quot;Warning: apply_corrections=true but regression_models is null. &quot;</span></div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Skipping corrections.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> {</div>
<div class="line">            result = result.<a id="a19" name="a19"></a><a class="code hl_function" href="classElemental__Profile.html#a1ae3b2f72eb66fb5ac7f195324f1dd41">ApplyOrganicMatterAndSizeCorrections</a>(</div>
<div class="line">                reference_om_size,</div>
<div class="line">                regression_models,</div>
<div class="line">                element_info</div>
<div class="line">            );</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Step 2: Filter elements if requested</span></div>
<div class="line">    <span class="keywordflow">if</span> (exclude_elements) {</div>
<div class="line">        <span class="keywordflow">if</span> (element_info == <span class="keyword">nullptr</span>) {</div>
<div class="line">            <span class="comment">// Log warning or throw exception in production code</span></div>
<div class="line">            std::cerr &lt;&lt; <span class="stringliteral">&quot;Warning: exclude_elements=true but element_info is null. &quot;</span></div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Skipping filtering.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> {</div>
<div class="line">            result = result.<a class="code hl_function" href="classElemental__Profile.html#a02d917a6cfb217a12d2015ff4460d780">CreateAnalysisProfile</a>(element_info);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> result;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_class" href="classElemental__Profile.html">Elemental_Profile</a> <a id="a20" name="a20"></a><a class="code hl_function" href="classElemental__Profile.html#a0541b570dda666bf2a3ddea2d6366c54">Elemental_Profile::ExtractChemicalElements</a>(</div>
<div class="line">    <span class="keyword">const</span> map&lt;string, element_information&gt;* element_info,</div>
<div class="line">    <span class="keywordtype">bool</span> include_isotopes)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">    <span class="comment">// Validate input - element_info is required</span></div>
<div class="line">    <span class="keywordflow">if</span> (element_info == <span class="keyword">nullptr</span>) {</div>
<div class="line">        <span class="comment">// For now, log error and return empty profile</span></div>
<div class="line">        <span class="comment">// Future: throw std::invalid_argument(&quot;element_info cannot be null&quot;)</span></div>
<div class="line">        std::cerr &lt;&lt; <span class="stringliteral">&quot;Error: ExtractChemicalElements called with null element_info. &quot;</span></div>
<div class="line">            &lt;&lt; <span class="stringliteral">&quot;Returning empty profile.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code hl_function" href="classElemental__Profile.html#ac74d62dcf559e0bc86414ee7b24bdc2a">Elemental_Profile</a>();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="classElemental__Profile.html">Elemental_Profile</a> extracted_profile;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Iterate through all elements in current profile</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [element_name, concentration] : *this) {</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Check if element exists in metadata</span></div>
<div class="line">        <span class="keyword">auto</span> info_iter = element_info-&gt;find(element_name);</div>
<div class="line">        <span class="keywordflow">if</span> (info_iter == element_info-&gt;end()) {</div>
<div class="line">            <span class="comment">// Element not in metadata - skip it</span></div>
<div class="line">            <span class="comment">// Could log warning: std::cerr &lt;&lt; &quot;Warning: Element &#39;&quot; &lt;&lt; element_name </span></div>
<div class="line">            <span class="comment">//                              &lt;&lt; &quot;&#39; not found in metadata. Skipping.\n&quot;;</span></div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_struct" href="structelement__information.html">element_information</a>&amp; info = info_iter-&gt;second;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Check if element should be included based on role</span></div>
<div class="line">        <span class="keywordtype">bool</span> should_include = <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (info.<a class="code hl_variable" href="structelement__information.html#a5f9e4723fe2c080ca91b31a8f697dd4e">Role</a> == <a class="code hl_enumvalue" href="structelement__information.html#a927baa115e71066b2964052d16cc474ca8e2dcfd7e7e24b1ca76c1193f645902b">element_information::role::element</a>) {</div>
<div class="line">            <span class="comment">// Always include chemical elements</span></div>
<div class="line">            should_include = <span class="keyword">true</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (info.<a class="code hl_variable" href="structelement__information.html#a5f9e4723fe2c080ca91b31a8f697dd4e">Role</a> == <a id="a21" name="a21"></a><a class="code hl_enumvalue" href="structelement__information.html#a927baa115e71066b2964052d16cc474caa8b1c31fc8c4c565d63b478eddb9b172">element_information::role::isotope</a>) {</div>
<div class="line">            <span class="comment">// Include isotopes only if requested</span></div>
<div class="line">            should_include = include_isotopes;</div>
<div class="line">        }</div>
<div class="line">        <span class="comment">// All other roles (organic_carbon, particle_size, do_not_include) are excluded</span></div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (should_include) {</div>
<div class="line">            extracted_profile[element_name] = concentration;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> extracted_profile;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_class" href="classElemental__Profile.html">Elemental_Profile</a> <a id="a22" name="a22"></a><a class="code hl_function" href="classElemental__Profile.html#a149f46abf0285a5c7b9f2c823479b1d8">Elemental_Profile::ExtractElements</a>(</div>
<div class="line">    <span class="keyword">const</span> vector&lt;string&gt;&amp; element_names)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">    <a class="code hl_class" href="classElemental__Profile.html">Elemental_Profile</a> extracted_profile;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Reserve space if we expect most elements to exist (optimization)</span></div>
<div class="line">    <span class="comment">// Note: Can&#39;t reserve in map, but this shows intent</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Iterate through requested elements</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; element_name : element_names) {</div>
<div class="line">        <span class="comment">// Check if element exists in current profile</span></div>
<div class="line">        <span class="keyword">auto</span> it = find(element_name);</div>
<div class="line">        <span class="keywordflow">if</span> (it != end()) {</div>
<div class="line">            <span class="comment">// Element exists - add to extracted profile</span></div>
<div class="line">            extracted_profile[element_name] = it-&gt;second;</div>
<div class="line">        }</div>
<div class="line">        <span class="comment">// Element doesn&#39;t exist - silently skip</span></div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> extracted_profile;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">double</span> <a id="a23" name="a23"></a><a class="code hl_function" href="classElemental__Profile.html#ac022b9ee818190fde138a0a5cbbed9b0">Elemental_Profile::GetValue</a>(<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; element_name)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">    <span class="keyword">auto</span> it = find(element_name);</div>
<div class="line">    <span class="keywordflow">if</span> (it == end()) {</div>
<div class="line">        <span class="keywordflow">throw</span> std::out_of_range(</div>
<div class="line">            <span class="stringliteral">&quot;Element &#39;&quot;</span> + element_name + <span class="stringliteral">&quot;&#39; does not exist in profile&quot;</span></div>
<div class="line">        );</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> it-&gt;second;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="keywordtype">bool</span> <a id="a24" name="a24"></a><a class="code hl_function" href="classElemental__Profile.html#af33d23d19061776c4f20120395c4ca35">Elemental_Profile::SetValue</a>(<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; element_name, <span class="keywordtype">double</span> value)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">auto</span> it = find(element_name);</div>
<div class="line">    <span class="keywordflow">if</span> (it == end()) {</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    it-&gt;second = value;</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> <span class="keywordtype">bool</span> <a id="a25" name="a25"></a><a class="code hl_function" href="classElemental__Profile.html#a82cc77b68f773d9c3214e6b20f3ded55">Elemental_Profile::SetMarked</a>(<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; element_name, <span class="keywordtype">bool</span> marked)</div>
<div class="line"> {</div>
<div class="line">     <span class="keywordflow">if</span> (find(element_name) == end()) {</div>
<div class="line">         <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">     }</div>
<div class="line"> </div>
<div class="line">     <a class="code hl_variable" href="classElemental__Profile.html#a20ba46ac0b29779bb16b8ce761b6c764">marked_elements_</a>[element_name] = marked;</div>
<div class="line">     <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"> }</div>
<div class="line"> </div>
<div class="line"> <span class="keywordtype">bool</span> <a id="a26" name="a26"></a><a class="code hl_function" href="classElemental__Profile.html#a1e87fa1b1f3782d18cc7456943e99be7">Elemental_Profile::IsMarked</a>(<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; element_name)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"> </span>{</div>
<div class="line">     <span class="keywordflow">if</span> (find(element_name) == end()) {</div>
<div class="line">         <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">     }</div>
<div class="line"> </div>
<div class="line">     <span class="keyword">auto</span> it = <a class="code hl_variable" href="classElemental__Profile.html#a20ba46ac0b29779bb16b8ce761b6c764">marked_elements_</a>.find(element_name);</div>
<div class="line">     <span class="keywordflow">return</span> (it != <a class="code hl_variable" href="classElemental__Profile.html#a20ba46ac0b29779bb16b8ce761b6c764">marked_elements_</a>.end() &amp;&amp; it-&gt;second);</div>
<div class="line"> }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="keywordtype">bool</span> <a class="code hl_function" href="classElemental__Profile.html#abd371be1a17109dbdb8517a29de516a3">Elemental_Profile::AppendElement</a>(<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; element_name, <span class="keywordtype">double</span> value)</div>
<div class="line"> {</div>
<div class="line">     <span class="keywordflow">if</span> (find(element_name) != end()) {</div>
<div class="line">         <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">     }</div>
<div class="line"> </div>
<div class="line">     (*this)[element_name] = value;</div>
<div class="line">     <a class="code hl_variable" href="classElemental__Profile.html#a20ba46ac0b29779bb16b8ce761b6c764">marked_elements_</a>[element_name] = <span class="keyword">false</span>;</div>
<div class="line">     <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"> }</div>
<div class="line"> </div>
<div class="line"> vector&lt;double&gt; <a id="a27" name="a27"></a><a class="code hl_function" href="classElemental__Profile.html#a7a155e3385f47495fc9cf8b317c2b6e4">Elemental_Profile::GetAllValues</a>()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"> </span>{</div>
<div class="line">     vector&lt;double&gt; values;</div>
<div class="line">     values.reserve(size());</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [element_name, concentration] : *this) {</div>
<div class="line">         values.push_back(concentration);</div>
<div class="line">     }</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">return</span> values;</div>
<div class="line"> }</div>
<div class="line"> </div>
<div class="line"> <span class="keywordtype">string</span> <a id="a28" name="a28"></a><a class="code hl_function" href="classElemental__Profile.html#ac8b5f0c66844ed8a06be1bb5c600ea1e">Elemental_Profile::ToString</a>()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"> </span>{</div>
<div class="line">     <span class="keywordtype">string</span> output;</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [element_name, concentration] : *this) {</div>
<div class="line">         output += element_name + <span class="stringliteral">&quot;:&quot;</span> + aquiutils::numbertostring(concentration) + <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">     }</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">return</span> output;</div>
<div class="line"> }</div>
<div class="line"> </div>
<div class="line"> QTableWidget* <a id="a29" name="a29"></a><a class="code hl_function" href="classElemental__Profile.html#a9339549be3522fda11453bf97d405ce0">Elemental_Profile::ToTable</a>()</div>
<div class="line"> {</div>
<div class="line">     QTableWidget* table = <span class="keyword">new</span> QTableWidget();</div>
<div class="line">     table-&gt;setEditTriggers(QAbstractItemView::NoEditTriggers);</div>
<div class="line">     table-&gt;setColumnCount(1);</div>
<div class="line">     table-&gt;setRowCount(size());</div>
<div class="line"> </div>
<div class="line">     QStringList headers;</div>
<div class="line">     QStringList element_names;</div>
<div class="line"> </div>
<div class="line">     <span class="keywordtype">int</span> row = 0;</div>
<div class="line">     <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [element_name, concentration] : *this) {</div>
<div class="line">         element_names &lt;&lt; QString::fromStdString(element_name);</div>
<div class="line">         table-&gt;setItem(row, 0, <span class="keyword">new</span> QTableWidgetItem(QString::number(concentration)));</div>
<div class="line"> </div>
<div class="line">         <span class="comment">// Highlight values outside limits if enabled</span></div>
<div class="line">         <span class="keywordflow">if</span> (<a id="a30" name="a30"></a><a class="code hl_variable" href="classInterface.html#acec157511b980b04f19ca39c97b19054">highlightoutsideoflimit</a> &amp;&amp;</div>
<div class="line">             (concentration &gt; <a id="a31" name="a31"></a><a class="code hl_variable" href="classInterface.html#afc616e2f2efcfa4bc781498b69384df2">highlimit</a> || concentration &lt; <a id="a32" name="a32"></a><a class="code hl_variable" href="classInterface.html#a24f0b4b925a432fdd21783e280997e9a">lowlimit</a>)) {</div>
<div class="line">             table-&gt;item(row, 0)-&gt;setForeground(QColor(Qt::red));</div>
<div class="line">         }</div>
<div class="line"> </div>
<div class="line">         row++;</div>
<div class="line">     }</div>
<div class="line"> </div>
<div class="line">     headers &lt;&lt; <a id="a33" name="a33"></a><a class="code hl_function" href="classInterface.html#ac0dc8a4ab6de18b9538d3764eb8bbf5a">YAxisLabel</a>();</div>
<div class="line">     table-&gt;setHorizontalHeaderLabels(headers);</div>
<div class="line">     table-&gt;setVerticalHeaderLabels(element_names);</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">return</span> table;</div>
<div class="line"> }</div>
<div class="line"> </div>
<div class="line"> QJsonObject <a id="a34" name="a34"></a><a class="code hl_function" href="classElemental__Profile.html#ae6d76197a4334b6db6160b19610d3c9d">Elemental_Profile::toJsonObject</a>()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"> </span>{</div>
<div class="line">     QJsonObject json_object;</div>
<div class="line">     QJsonObject element_contents;</div>
<div class="line"> </div>
<div class="line">     json_object[<span class="stringliteral">&quot;Include&quot;</span>] = <a id="a35" name="a35"></a><a class="code hl_function" href="classElemental__Profile.html#af21fb541c1e8e760f5f7adae8b00dde7">IsIncludedInAnalysis</a>();</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [element_name, concentration] : *this) {</div>
<div class="line">         element_contents[QString::fromStdString(element_name)] = concentration;</div>
<div class="line">     }</div>
<div class="line"> </div>
<div class="line">     json_object[<span class="stringliteral">&quot;Element Contents&quot;</span>] = element_contents;</div>
<div class="line">     json_object[<span class="stringliteral">&quot;XAxisLabel&quot;</span>] = <a id="a36" name="a36"></a><a class="code hl_function" href="classInterface.html#a6cec95c20f7c8c8328f7dfc922309749">XAxisLabel</a>();</div>
<div class="line">     json_object[<span class="stringliteral">&quot;YAxisLabel&quot;</span>] = <a class="code hl_function" href="classInterface.html#ac0dc8a4ab6de18b9538d3764eb8bbf5a">YAxisLabel</a>();</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">return</span> json_object;</div>
<div class="line"> }</div>
<div class="line"> </div>
<div class="line"> <span class="keywordtype">bool</span> <a id="a37" name="a37"></a><a class="code hl_function" href="classElemental__Profile.html#ae0bbd09b3e12a3eeb806c07c64ace333">Elemental_Profile::ReadFromJsonObject</a>(<span class="keyword">const</span> QJsonObject&amp; json_object)</div>
<div class="line"> {</div>
<div class="line">     clear();</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">if</span> (json_object.contains(<span class="stringliteral">&quot;Include&quot;</span>)) {</div>
<div class="line">         <span class="comment">// Full format with metadata</span></div>
<div class="line">         <a id="a38" name="a38"></a><a class="code hl_function" href="classElemental__Profile.html#aa8163f73d23a6a59a053f4535a23c652">SetIncludedInAnalysis</a>(json_object[<span class="stringliteral">&quot;Include&quot;</span>].toBool());</div>
<div class="line"> </div>
<div class="line">         QJsonObject contents = json_object[<span class="stringliteral">&quot;Element Contents&quot;</span>].toObject();</div>
<div class="line">         <span class="keywordflow">for</span> (<span class="keyword">const</span> QString&amp; key : contents.keys()) {</div>
<div class="line">             (*this)[key.toStdString()] = contents[key].toDouble();</div>
<div class="line">         }</div>
<div class="line">     }</div>
<div class="line">     <span class="keywordflow">else</span> {</div>
<div class="line">         <span class="comment">// Legacy format - elements directly in root</span></div>
<div class="line">         <span class="keywordflow">for</span> (<span class="keyword">const</span> QString&amp; key : json_object.keys()) {</div>
<div class="line">             (*this)[key.toStdString()] = json_object[key].toDouble();</div>
<div class="line">         }</div>
<div class="line">     }</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">if</span> (json_object.contains(<span class="stringliteral">&quot;XAxisLabel&quot;</span>)) {</div>
<div class="line">         <a id="a39" name="a39"></a><a class="code hl_function" href="classInterface.html#a9543100e7a8dfce3db64dec59d5bef60">SetXAxisLabel</a>(json_object[<span class="stringliteral">&quot;XAxisLabel&quot;</span>].toString());</div>
<div class="line">     }</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">if</span> (json_object.contains(<span class="stringliteral">&quot;YAxisLabel&quot;</span>)) {</div>
<div class="line">         <a id="a40" name="a40"></a><a class="code hl_function" href="classInterface.html#afc32c062b437f34324478d35cfeb54b5">SetYAxisLabel</a>(json_object[<span class="stringliteral">&quot;YAxisLabel&quot;</span>].toString());  <span class="comment">// Fixed: was SetXAxisLabel</span></div>
<div class="line">     }</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"> }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="keywordtype">bool</span> <a id="a41" name="a41"></a><a class="code hl_function" href="classElemental__Profile.html#af63837f23db8c25fbd1414451c367403">Elemental_Profile::Read</a>(<span class="keyword">const</span> QStringList&amp; string_list)</div>
<div class="line"> {</div>
<div class="line">     clear();</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">for</span> (<span class="keyword">const</span> QString&amp; line : string_list) {</div>
<div class="line">         QStringList parts = line.split(<span class="stringliteral">&quot;:&quot;</span>);</div>
<div class="line">         <span class="keywordflow">if</span> (parts.size() &gt; 1) {</div>
<div class="line">             <a class="code hl_function" href="classElemental__Profile.html#abd371be1a17109dbdb8517a29de516a3">AppendElement</a>(parts[0].toStdString(), parts[1].toDouble());</div>
<div class="line">         }</div>
<div class="line">     }</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"> }</div>
<div class="line"> </div>
<div class="line"> <span class="keywordtype">bool</span> <a id="a42" name="a42"></a><a class="code hl_function" href="classElemental__Profile.html#adff28a214b4cd5d4abef75d7067fc942">Elemental_Profile::writetofile</a>(QFile* file)</div>
<div class="line"> {</div>
<div class="line">     file-&gt;write(QString::fromStdString(<a class="code hl_function" href="classElemental__Profile.html#ac8b5f0c66844ed8a06be1bb5c600ea1e">ToString</a>()).toUtf8());</div>
<div class="line">     <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"> }</div>
<div class="line"> </div>
<div class="line"> <span class="keywordtype">double</span> <a id="a43" name="a43"></a><a class="code hl_function" href="classElemental__Profile.html#a28feb4c1d0486aa25c6602f33b7d3d9a">Elemental_Profile::GetMaximum</a>()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"> </span>{</div>
<div class="line">     <span class="keywordflow">if</span> (empty()) {</div>
<div class="line">         <span class="keywordflow">return</span> -1e12;</div>
<div class="line">     }</div>
<div class="line"> </div>
<div class="line">     <span class="keywordtype">double</span> max_value = -1e12;</div>
<div class="line">     <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [element_name, concentration] : *this) {</div>
<div class="line">         <span class="keywordflow">if</span> (concentration &gt; max_value) {</div>
<div class="line">             max_value = concentration;</div>
<div class="line">         }</div>
<div class="line">     }</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">return</span> max_value;</div>
<div class="line"> }</div>
<div class="line"> </div>
<div class="line"> <span class="keywordtype">double</span> <a id="a44" name="a44"></a><a class="code hl_function" href="classElemental__Profile.html#a5007d301571db4ce04f2430635694710">Elemental_Profile::GetMinimum</a>()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"> </span>{</div>
<div class="line">     <span class="keywordflow">if</span> (empty()) {</div>
<div class="line">         <span class="keywordflow">return</span> 1e12;</div>
<div class="line">     }</div>
<div class="line"> </div>
<div class="line">     <span class="keywordtype">double</span> min_value = 1e12;</div>
<div class="line">     <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [element_name, concentration] : *this) {</div>
<div class="line">         <span class="keywordflow">if</span> (concentration &lt; min_value) {</div>
<div class="line">             min_value = concentration;</div>
<div class="line">         }</div>
<div class="line">     }</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">return</span> min_value;</div>
<div class="line"> }</div>
<div class="line"> </div>
<div class="line"> vector&lt;string&gt; <a id="a45" name="a45"></a><a class="code hl_function" href="classElemental__Profile.html#a295397bcb07225d953471aa26b367cdd">Elemental_Profile::GetElementNames</a>()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"> </span>{</div>
<div class="line">     vector&lt;string&gt; names;</div>
<div class="line">     names.reserve(size());</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [element_name, concentration] : *this) {</div>
<div class="line">         names.push_back(element_name);</div>
<div class="line">     }</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">return</span> names;</div>
<div class="line"> }</div>
<div class="line"> </div>
<div class="line"> <span class="keywordtype">bool</span> <a id="a46" name="a46"></a><a class="code hl_function" href="classElemental__Profile.html#af7ee759943443d6251d30927f51847f9">Elemental_Profile::Contains</a>(<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; element_name)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"> </span>{</div>
<div class="line">     <span class="keywordflow">return</span> (find(element_name) != end());</div>
<div class="line"> }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <a class="code hl_class" href="classElemental__Profile.html">Elemental_Profile</a> <a class="code hl_function" href="classElemental__Profile.html#a1ae3b2f72eb66fb5ac7f195324f1dd41">Elemental_Profile::ApplyOrganicMatterAndSizeCorrections</a>(</div>
<div class="line">     <span class="keyword">const</span> vector&lt;double&gt;&amp; reference_om_size,</div>
<div class="line">     <span class="keyword">const</span> <a class="code hl_class" href="classMultipleLinearRegressionSet.html">MultipleLinearRegressionSet</a>* regression_models,</div>
<div class="line">     <span class="keyword">const</span> map&lt;string, element_information&gt;* element_info)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"> </span>{</div>
<div class="line">     <a class="code hl_class" href="classElemental__Profile.html">Elemental_Profile</a> corrected_profile;</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [element_name, concentration] : *this) {</div>
<div class="line">         <span class="keyword">const</span> <a class="code hl_struct" href="structelement__information.html">element_information</a>&amp; info = element_info-&gt;at(element_name);</div>
<div class="line"> </div>
<div class="line">         <span class="comment">// Skip organic carbon and particle size indicators</span></div>
<div class="line">         <span class="keywordflow">if</span> (info.<a class="code hl_variable" href="structelement__information.html#a5f9e4723fe2c080ca91b31a8f697dd4e">Role</a> == <a class="code hl_enumvalue" href="structelement__information.html#a927baa115e71066b2964052d16cc474cad504cad7691c7cb1144d2d226edf6f94">element_information::role::organic_carbon</a> ||</div>
<div class="line">             info.<a class="code hl_variable" href="structelement__information.html#a5f9e4723fe2c080ca91b31a8f697dd4e">Role</a> == <a class="code hl_enumvalue" href="structelement__information.html#a927baa115e71066b2964052d16cc474cae44ba3cbb5cd522611b75a74e6a4ba8b">element_information::role::particle_size</a>) {</div>
<div class="line">             <span class="keywordflow">continue</span>;</div>
<div class="line">         }</div>
<div class="line"> </div>
<div class="line">         <span class="comment">// Start with original concentration</span></div>
<div class="line">         corrected_profile[element_name] = concentration;</div>
<div class="line"> </div>
<div class="line">         <span class="comment">// Apply corrections if regression model exists for this element</span></div>
<div class="line">         <span class="keywordflow">if</span> (regression_models-&gt;count(element_name) == 0) {</div>
<div class="line">             <span class="keywordflow">continue</span>;</div>
<div class="line">         }</div>
<div class="line"> </div>
<div class="line">         <span class="keyword">const</span> <a id="_a47" name="_a47"></a><a class="code hl_class" href="classMultipleLinearRegression.html">MultipleLinearRegression</a>* <a id="a48" name="a48"></a><a class="code hl_enumvalue" href="resultitem_8h.html#ae0bada42736b9c6772b26fad4557dbd7afac131120365e920d07c1ef7f062c7b0">mlr</a> = &amp;regression_models-&gt;at(element_name);</div>
<div class="line">         <span class="keyword">const</span> <span class="keyword">auto</span>&amp; var_names = <a class="code hl_enumvalue" href="resultitem_8h.html#ae0bada42736b9c6772b26fad4557dbd7afac131120365e920d07c1ef7f062c7b0">mlr</a>-&gt;GetIndependentVariableNames();</div>
<div class="line">         <span class="keyword">const</span> <span class="keyword">auto</span>&amp; coefficients = <a class="code hl_enumvalue" href="resultitem_8h.html#ae0bada42736b9c6772b26fad4557dbd7afac131120365e920d07c1ef7f062c7b0">mlr</a>-&gt;CoefficientsIntercept();</div>
<div class="line">         <span class="keywordtype">bool</span> is_linear = (<a class="code hl_enumvalue" href="resultitem_8h.html#ae0bada42736b9c6772b26fad4557dbd7afac131120365e920d07c1ef7f062c7b0">mlr</a>-&gt;Equation() == <a id="a49" name="a49"></a><a class="code hl_enumvalue" href="multiplelinearregression_8h.html#a126d68f6f19dcf3ad6b16e179766a91fa9a932b3cb396238423eb2f33ec17d6aa">regression_form::linear</a>);</div>
<div class="line"> </div>
<div class="line">         <span class="comment">// Apply first correction (typically organic matter)</span></div>
<div class="line">         <span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="resultitem_8h.html#ae0bada42736b9c6772b26fad4557dbd7afac131120365e920d07c1ef7f062c7b0">mlr</a>-&gt;Effective(0) &amp;&amp; var_names[0] != element_name) {</div>
<div class="line">             <span class="keywordtype">double</span> reference = reference_om_size[0];</div>
<div class="line">             <span class="keywordtype">double</span> measured = this-&gt;at(var_names[0]);</div>
<div class="line"> </div>
<div class="line">             <span class="keywordflow">if</span> (is_linear) {</div>
<div class="line">                 corrected_profile[element_name] += (reference - measured) * coefficients[1];</div>
<div class="line">             }</div>
<div class="line">             <span class="keywordflow">else</span> {</div>
<div class="line">                 corrected_profile[element_name] *= pow(reference / measured, coefficients[1]);</div>
<div class="line">             }</div>
<div class="line">         }</div>
<div class="line"> </div>
<div class="line">         <span class="comment">// Apply second correction (typically particle size) if available</span></div>
<div class="line">         <span class="keywordflow">if</span> (var_names.size() &gt; 1 &amp;&amp; <a class="code hl_enumvalue" href="resultitem_8h.html#ae0bada42736b9c6772b26fad4557dbd7afac131120365e920d07c1ef7f062c7b0">mlr</a>-&gt;Effective(1) &amp;&amp; var_names[1] != element_name) {</div>
<div class="line">             <span class="keywordtype">double</span> reference = reference_om_size[1];</div>
<div class="line">             <span class="keywordtype">double</span> measured = this-&gt;at(var_names[1]);</div>
<div class="line"> </div>
<div class="line">             <span class="keywordflow">if</span> (is_linear) {</div>
<div class="line">                 corrected_profile[element_name] += (reference - measured) * coefficients[2];</div>
<div class="line">             }</div>
<div class="line">             <span class="keywordflow">else</span> {</div>
<div class="line">                 corrected_profile[element_name] *= pow(reference / measured, coefficients[2]);</div>
<div class="line">             }</div>
<div class="line">         }</div>
<div class="line"> </div>
<div class="line">         <span class="comment">// Warn about negative corrected values (except for isotopes)</span></div>
<div class="line">         <span class="keywordflow">if</span> (corrected_profile[element_name] &lt; 0 &amp;&amp;</div>
<div class="line">             info.<a class="code hl_variable" href="structelement__information.html#a5f9e4723fe2c080ca91b31a8f697dd4e">Role</a> != <a class="code hl_enumvalue" href="structelement__information.html#a927baa115e71066b2964052d16cc474caa8b1c31fc8c4c565d63b478eddb9b172">element_information::role::isotope</a>) {</div>
<div class="line">             std::cerr &lt;&lt; <span class="stringliteral">&quot;Warning: Corrected value for &quot;</span> &lt;&lt; element_name</div>
<div class="line">                 &lt;&lt; <span class="stringliteral">&quot; is negative: &quot;</span> &lt;&lt; corrected_profile[element_name] &lt;&lt; std::endl;</div>
<div class="line">         }</div>
<div class="line">     }</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">return</span> corrected_profile;</div>
<div class="line"> }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="keywordtype">double</span> <a id="a50" name="a50"></a><a class="code hl_function" href="classElemental__Profile.html#a2b81a2859a02a4ac85df7eb243f594c3">Elemental_Profile::CalculateDotProduct</a>(<span class="keyword">const</span> <a id="_a51" name="_a51"></a><a class="code hl_class" href="classCMBVector.html">CMBVector</a>&amp; weights)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"> </span>{</div>
<div class="line">     <span class="keywordflow">if</span> (size() != weights.getsize()) {</div>
<div class="line">         <span class="keywordflow">return</span> -999;</div>
<div class="line">     }</div>
<div class="line"> </div>
<div class="line">     <span class="keywordtype">double</span> sum = 0.0;</div>
<div class="line">     <span class="keywordtype">int</span> index = 0;</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [element_name, concentration] : *this) {</div>
<div class="line">         sum += concentration * weights[index];</div>
<div class="line">         index++;</div>
<div class="line">     }</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">return</span> sum;</div>
<div class="line"> }</div>
<div class="line"> </div>
<div class="line"> <a class="code hl_class" href="classCMBVector.html">CMBVector</a> <a id="a52" name="a52"></a><a class="code hl_function" href="classElemental__Profile.html#a3353e492c0cd55969e72d6e990cda355">Elemental_Profile::SortByConcentration</a>(<span class="keywordtype">bool</span> ascending)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"> </span>{</div>
<div class="line">     <a class="code hl_class" href="classCMBVector.html">CMBVector</a> sorted_result;</div>
<div class="line">     vector&lt;string&gt; processed_elements;</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; size(); i++) {</div>
<div class="line">         <span class="keywordtype">double</span> target_value = ascending ? 1e6 : -1e6;</div>
<div class="line">         <span class="keywordtype">string</span> target_element;</div>
<div class="line"> </div>
<div class="line">         <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [element_name, concentration] : *this) {</div>
<div class="line">             <span class="comment">// Skip already processed elements</span></div>
<div class="line">             <span class="keywordflow">if</span> (lookup(processed_elements, element_name) != -1) {</div>
<div class="line">                 <span class="keywordflow">continue</span>;</div>
<div class="line">             }</div>
<div class="line"> </div>
<div class="line">             <span class="comment">// Find min (ascending) or max (descending)</span></div>
<div class="line">             <span class="keywordtype">bool</span> is_better = ascending ? (concentration &lt; target_value)</div>
<div class="line">                 : (concentration &gt; target_value);</div>
<div class="line"> </div>
<div class="line">             <span class="keywordflow">if</span> (is_better) {</div>
<div class="line">                 target_element = element_name;</div>
<div class="line">                 target_value = concentration;</div>
<div class="line">             }</div>
<div class="line">         }</div>
<div class="line"> </div>
<div class="line">         processed_elements.push_back(target_element);</div>
<div class="line">         sorted_result.<a id="a53" name="a53"></a><a class="code hl_function" href="classCMBVector.html#ab9fd007cf960fe8d1538cc48aa4dbf0f">append</a>(target_element, target_value);</div>
<div class="line">     }</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">return</span> sorted_result;</div>
<div class="line"> }</div>
<div class="line"> </div>
<div class="line"> vector&lt;string&gt; <a id="a54" name="a54"></a><a class="code hl_function" href="classElemental__Profile.html#ac612e5ce6ee3566ace1a718dda5e4c7d">Elemental_Profile::SelectTopElements</a>(<span class="keywordtype">int</span> n, <span class="keywordtype">bool</span> ascending)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"> </span>{</div>
<div class="line">     <a class="code hl_class" href="classCMBVector.html">CMBVector</a> sorted = <a class="code hl_function" href="classElemental__Profile.html#a3353e492c0cd55969e72d6e990cda355">SortByConcentration</a>(ascending);</div>
<div class="line">     vector&lt;string&gt; top_elements;</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n &amp;&amp; i &lt; sorted.num; i++) {</div>
<div class="line">         top_elements.push_back(sorted.<a id="a55" name="a55"></a><a class="code hl_function" href="classCMBVector.html#adac7688c971cd9680324eb0bc002134e">Label</a>(i));</div>
<div class="line">     }</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">return</span> top_elements;</div>
<div class="line"> }</div>
<div class="ttc" id="aclassCMBVector_html"><div class="ttname"><a href="classCMBVector.html">CMBVector</a></div><div class="ttdoc">Vector class with string labels for Chemical Mass Balance analysis.</div><div class="ttdef"><b>Definition</b> <a href="cmbvector_8h_source.html#l00016">cmbvector.h:17</a></div></div>
<div class="ttc" id="aclassCMBVector_html_ab9fd007cf960fe8d1538cc48aa4dbf0f"><div class="ttname"><a href="classCMBVector.html#ab9fd007cf960fe8d1538cc48aa4dbf0f">CMBVector::append</a></div><div class="ttdeci">void append(const string &amp;label, const double &amp;val)</div><div class="ttdoc">Appends a labeled element to the vector.</div><div class="ttdef"><b>Definition</b> <a href="cmbvector_8cpp_source.html#l00272">cmbvector.cpp:272</a></div></div>
<div class="ttc" id="aclassCMBVector_html_adac7688c971cd9680324eb0bc002134e"><div class="ttname"><a href="classCMBVector.html#adac7688c971cd9680324eb0bc002134e">CMBVector::Label</a></div><div class="ttdeci">string Label(int i) const</div><div class="ttdoc">Gets label at specified index.</div><div class="ttdef"><b>Definition</b> <a href="cmbvector_8h_source.html#l00118">cmbvector.h:118</a></div></div>
<div class="ttc" id="aclassElemental__Profile_html_a0081cfc8b373ed0f6111d866361181e8"><div class="ttname"><a href="classElemental__Profile.html#a0081cfc8b373ed0f6111d866361181e8">Elemental_Profile::operator=</a></div><div class="ttdeci">Elemental_Profile &amp; operator=(const Elemental_Profile &amp;other)</div><div class="ttdoc">Copy assignment operator.</div><div class="ttdef"><b>Definition</b> <a href="elemental__profile_8cpp_source.html#l00083">elemental_profile.cpp:83</a></div></div>
<div class="ttc" id="aclassElemental__Profile_html_a0541b570dda666bf2a3ddea2d6366c54"><div class="ttname"><a href="classElemental__Profile.html#a0541b570dda666bf2a3ddea2d6366c54">Elemental_Profile::ExtractChemicalElements</a></div><div class="ttdeci">Elemental_Profile ExtractChemicalElements(const map&lt; string, element_information &gt; *elementinfo, bool include_isotopes=false) const</div><div class="ttdoc">Extract chemical elements only (exclude isotopes, metadata)</div><div class="ttdef"><b>Definition</b> <a href="elemental__profile_8cpp_source.html#l00330">elemental_profile.cpp:330</a></div></div>
<div class="ttc" id="aclassElemental__Profile_html_a149f46abf0285a5c7b9f2c823479b1d8"><div class="ttname"><a href="classElemental__Profile.html#a149f46abf0285a5c7b9f2c823479b1d8">Elemental_Profile::ExtractElements</a></div><div class="ttdeci">Elemental_Profile ExtractElements(const vector&lt; string &gt; &amp;element_names) const</div><div class="ttdoc">Extract subset of specified elements.</div><div class="ttdef"><b>Definition</b> <a href="elemental__profile_8cpp_source.html#l00421">elemental_profile.cpp:421</a></div></div>
<div class="ttc" id="aclassElemental__Profile_html_a1ae3b2f72eb66fb5ac7f195324f1dd41"><div class="ttname"><a href="classElemental__Profile.html#a1ae3b2f72eb66fb5ac7f195324f1dd41">Elemental_Profile::ApplyOrganicMatterAndSizeCorrections</a></div><div class="ttdeci">Elemental_Profile ApplyOrganicMatterAndSizeCorrections(const vector&lt; double &gt; &amp;reference_om_size, const MultipleLinearRegressionSet *regression_models, const map&lt; string, element_information &gt; *elementinfo=nullptr) const</div><div class="ttdoc">Apply organic matter and particle size corrections.</div><div class="ttdef"><b>Definition</b> <a href="elemental__profile_8cpp_source.html#l00878">elemental_profile.cpp:878</a></div></div>
<div class="ttc" id="aclassElemental__Profile_html_a1e87fa1b1f3782d18cc7456943e99be7"><div class="ttname"><a href="classElemental__Profile.html#a1e87fa1b1f3782d18cc7456943e99be7">Elemental_Profile::IsMarked</a></div><div class="ttdeci">bool IsMarked(const string &amp;name) const</div><div class="ttdoc">Check if element is marked.</div><div class="ttdef"><b>Definition</b> <a href="elemental__profile_8cpp_source.html#l00525">elemental_profile.cpp:525</a></div></div>
<div class="ttc" id="aclassElemental__Profile_html_a20ba46ac0b29779bb16b8ce761b6c764"><div class="ttname"><a href="classElemental__Profile.html#a20ba46ac0b29779bb16b8ce761b6c764">Elemental_Profile::marked_elements_</a></div><div class="ttdeci">map&lt; string, bool &gt; marked_elements_</div><div class="ttdoc">Map tracking marked elements for quality control.</div><div class="ttdef"><b>Definition</b> <a href="elemental__profile_8h_source.html#l00484">elemental_profile.h:484</a></div></div>
<div class="ttc" id="aclassElemental__Profile_html_a28feb4c1d0486aa25c6602f33b7d3d9a"><div class="ttname"><a href="classElemental__Profile.html#a28feb4c1d0486aa25c6602f33b7d3d9a">Elemental_Profile::GetMaximum</a></div><div class="ttdeci">double GetMaximum() const</div><div class="ttdoc">Get maximum concentration value.</div><div class="ttdef"><b>Definition</b> <a href="elemental__profile_8cpp_source.html#l00793">elemental_profile.cpp:793</a></div></div>
<div class="ttc" id="aclassElemental__Profile_html_a295397bcb07225d953471aa26b367cdd"><div class="ttname"><a href="classElemental__Profile.html#a295397bcb07225d953471aa26b367cdd">Elemental_Profile::GetElementNames</a></div><div class="ttdeci">vector&lt; string &gt; GetElementNames() const</div><div class="ttdoc">Get list of all element names.</div><div class="ttdef"><b>Definition</b> <a href="elemental__profile_8cpp_source.html#l00839">elemental_profile.cpp:839</a></div></div>
<div class="ttc" id="aclassElemental__Profile_html_a2b81a2859a02a4ac85df7eb243f594c3"><div class="ttname"><a href="classElemental__Profile.html#a2b81a2859a02a4ac85df7eb243f594c3">Elemental_Profile::CalculateDotProduct</a></div><div class="ttdeci">double CalculateDotProduct(const CMBVector &amp;weights) const</div><div class="ttdoc">Calculate dot product with weight vector.</div><div class="ttdef"><b>Definition</b> <a href="elemental__profile_8cpp_source.html#l00959">elemental_profile.cpp:959</a></div></div>
<div class="ttc" id="aclassElemental__Profile_html_a3353e492c0cd55969e72d6e990cda355"><div class="ttname"><a href="classElemental__Profile.html#a3353e492c0cd55969e72d6e990cda355">Elemental_Profile::SortByConcentration</a></div><div class="ttdeci">CMBVector SortByConcentration(bool ascending=true) const</div><div class="ttdoc">Sort elements by concentration value.</div><div class="ttdef"><b>Definition</b> <a href="elemental__profile_8cpp_source.html#l00988">elemental_profile.cpp:988</a></div></div>
<div class="ttc" id="aclassElemental__Profile_html_a4bdadf68530b434fb7be463ac65d1f3a"><div class="ttname"><a href="classElemental__Profile.html#a4bdadf68530b434fb7be463ac65d1f3a">Elemental_Profile::included_in_analysis_</a></div><div class="ttdeci">bool included_in_analysis_</div><div class="ttdoc">Whether profile should be included in analysis.</div><div class="ttdef"><b>Definition</b> <a href="elemental__profile_8h_source.html#l00476">elemental_profile.h:476</a></div></div>
<div class="ttc" id="aclassElemental__Profile_html_a5007d301571db4ce04f2430635694710"><div class="ttname"><a href="classElemental__Profile.html#a5007d301571db4ce04f2430635694710">Elemental_Profile::GetMinimum</a></div><div class="ttdeci">double GetMinimum() const</div><div class="ttdoc">Get minimum concentration value.</div><div class="ttdef"><b>Definition</b> <a href="elemental__profile_8cpp_source.html#l00818">elemental_profile.cpp:818</a></div></div>
<div class="ttc" id="aclassElemental__Profile_html_a7a155e3385f47495fc9cf8b317c2b6e4"><div class="ttname"><a href="classElemental__Profile.html#a7a155e3385f47495fc9cf8b317c2b6e4">Elemental_Profile::GetAllValues</a></div><div class="ttdeci">vector&lt; double &gt; GetAllValues() const</div><div class="ttdoc">Get all concentration values as vector.</div><div class="ttdef"><b>Definition</b> <a href="elemental__profile_8cpp_source.html#l00575">elemental_profile.cpp:575</a></div></div>
<div class="ttc" id="aclassElemental__Profile_html_a82cc77b68f773d9c3214e6b20f3ded55"><div class="ttname"><a href="classElemental__Profile.html#a82cc77b68f773d9c3214e6b20f3ded55">Elemental_Profile::SetMarked</a></div><div class="ttdeci">bool SetMarked(const string &amp;name, bool marked)</div><div class="ttdoc">Set marked status for an element.</div><div class="ttdef"><b>Definition</b> <a href="elemental__profile_8cpp_source.html#l00507">elemental_profile.cpp:507</a></div></div>
<div class="ttc" id="aclassElemental__Profile_html_a9339549be3522fda11453bf97d405ce0"><div class="ttname"><a href="classElemental__Profile.html#a9339549be3522fda11453bf97d405ce0">Elemental_Profile::ToTable</a></div><div class="ttdeci">QTableWidget * ToTable() override</div><div class="ttdoc">Create Qt table widget representation.</div><div class="ttdef"><b>Definition</b> <a href="elemental__profile_8cpp_source.html#l00632">elemental_profile.cpp:632</a></div></div>
<div class="ttc" id="aclassElemental__Profile_html_aa8163f73d23a6a59a053f4535a23c652"><div class="ttname"><a href="classElemental__Profile.html#aa8163f73d23a6a59a053f4535a23c652">Elemental_Profile::SetIncludedInAnalysis</a></div><div class="ttdeci">void SetIncludedInAnalysis(bool included)</div><div class="ttdoc">Set analysis inclusion status.</div><div class="ttdef"><b>Definition</b> <a href="elemental__profile_8h_source.html#l00406">elemental_profile.h:406</a></div></div>
<div class="ttc" id="aclassElemental__Profile_html_ab22dbed07fdb56b97cf9bccab22545cc"><div class="ttname"><a href="classElemental__Profile.html#ab22dbed07fdb56b97cf9bccab22545cc">Elemental_Profile::CreateCorrectedProfile</a></div><div class="ttdeci">Elemental_Profile CreateCorrectedProfile(bool exclude_elements, bool apply_corrections, const vector&lt; double &gt; &amp;reference_om_size, const MultipleLinearRegressionSet *regression_models=nullptr, const map&lt; string, element_information &gt; *elementinfo=nullptr) const</div><div class="ttdoc">Create corrected profile with filtering and corrections.</div><div class="ttdef"><b>Definition</b> <a href="elemental__profile_8cpp_source.html#l00240">elemental_profile.cpp:240</a></div></div>
<div class="ttc" id="aclassElemental__Profile_html_ac022b9ee818190fde138a0a5cbbed9b0"><div class="ttname"><a href="classElemental__Profile.html#ac022b9ee818190fde138a0a5cbbed9b0">Elemental_Profile::GetValue</a></div><div class="ttdeci">double GetValue(const string &amp;name) const</div><div class="ttdoc">Get element concentration by name.</div><div class="ttdef"><b>Definition</b> <a href="elemental__profile_8cpp_source.html#l00450">elemental_profile.cpp:450</a></div></div>
<div class="ttc" id="aclassElemental__Profile_html_ac612e5ce6ee3566ace1a718dda5e4c7d"><div class="ttname"><a href="classElemental__Profile.html#ac612e5ce6ee3566ace1a718dda5e4c7d">Elemental_Profile::SelectTopElements</a></div><div class="ttdeci">vector&lt; string &gt; SelectTopElements(int n, bool ascending=true) const</div><div class="ttdoc">Select top N elements by concentration.</div><div class="ttdef"><b>Definition</b> <a href="elemental__profile_8cpp_source.html#l01032">elemental_profile.cpp:1032</a></div></div>
<div class="ttc" id="aclassElemental__Profile_html_ac74d62dcf559e0bc86414ee7b24bdc2a"><div class="ttname"><a href="classElemental__Profile.html#ac74d62dcf559e0bc86414ee7b24bdc2a">Elemental_Profile::Elemental_Profile</a></div><div class="ttdeci">Elemental_Profile()</div><div class="ttdoc">Default constructor - creates empty profile.</div><div class="ttdef"><b>Definition</b> <a href="elemental__profile_8cpp_source.html#l00030">elemental_profile.cpp:30</a></div></div>
<div class="ttc" id="aclassElemental__Profile_html_ac8b5f0c66844ed8a06be1bb5c600ea1e"><div class="ttname"><a href="classElemental__Profile.html#ac8b5f0c66844ed8a06be1bb5c600ea1e">Elemental_Profile::ToString</a></div><div class="ttdeci">string ToString() const override</div><div class="ttdoc">Convert profile to string representation.</div><div class="ttdef"><b>Definition</b> <a href="elemental__profile_8cpp_source.html#l00599">elemental_profile.cpp:599</a></div></div>
<div class="ttc" id="aclassElemental__Profile_html_adff28a214b4cd5d4abef75d7067fc942"><div class="ttname"><a href="classElemental__Profile.html#adff28a214b4cd5d4abef75d7067fc942">Elemental_Profile::writetofile</a></div><div class="ttdeci">bool writetofile(QFile *file) override</div><div class="ttdoc">Write profile to file.</div><div class="ttdef"><b>Definition</b> <a href="elemental__profile_8cpp_source.html#l00778">elemental_profile.cpp:778</a></div></div>
<div class="ttc" id="aclassElemental__Profile_html_ae0bbd09b3e12a3eeb806c07c64ace333"><div class="ttname"><a href="classElemental__Profile.html#ae0bbd09b3e12a3eeb806c07c64ace333">Elemental_Profile::ReadFromJsonObject</a></div><div class="ttdeci">bool ReadFromJsonObject(const QJsonObject &amp;json) override</div><div class="ttdoc">Deserialize from JSON object.</div><div class="ttdef"><b>Definition</b> <a href="elemental__profile_8cpp_source.html#l00707">elemental_profile.cpp:707</a></div></div>
<div class="ttc" id="aclassElemental__Profile_html_ae6d76197a4334b6db6160b19610d3c9d"><div class="ttname"><a href="classElemental__Profile.html#ae6d76197a4334b6db6160b19610d3c9d">Elemental_Profile::toJsonObject</a></div><div class="ttdeci">QJsonObject toJsonObject() const override</div><div class="ttdoc">Serialize to JSON object.</div><div class="ttdef"><b>Definition</b> <a href="elemental__profile_8cpp_source.html#l00674">elemental_profile.cpp:674</a></div></div>
<div class="ttc" id="aclassElemental__Profile_html_af21fb541c1e8e760f5f7adae8b00dde7"><div class="ttname"><a href="classElemental__Profile.html#af21fb541c1e8e760f5f7adae8b00dde7">Elemental_Profile::IsIncludedInAnalysis</a></div><div class="ttdeci">bool IsIncludedInAnalysis() const</div><div class="ttdoc">Check if profile is included in analysis.</div><div class="ttdef"><b>Definition</b> <a href="elemental__profile_8h_source.html#l00399">elemental_profile.h:399</a></div></div>
<div class="ttc" id="aclassElemental__Profile_html_af33d23d19061776c4f20120395c4ca35"><div class="ttname"><a href="classElemental__Profile.html#af33d23d19061776c4f20120395c4ca35">Elemental_Profile::SetValue</a></div><div class="ttdeci">bool SetValue(const string &amp;name, double val)</div><div class="ttdoc">Set concentration value for existing element.</div><div class="ttdef"><b>Definition</b> <a href="elemental__profile_8cpp_source.html#l00484">elemental_profile.cpp:484</a></div></div>
<div class="ttc" id="aclassElemental__Profile_html_af63837f23db8c25fbd1414451c367403"><div class="ttname"><a href="classElemental__Profile.html#af63837f23db8c25fbd1414451c367403">Elemental_Profile::Read</a></div><div class="ttdeci">bool Read(const QStringList &amp;string_list) override</div><div class="ttdoc">Read profile from string list.</div><div class="ttdef"><b>Definition</b> <a href="elemental__profile_8cpp_source.html#l00753">elemental_profile.cpp:753</a></div></div>
<div class="ttc" id="aclassElemental__Profile_html_af7ee759943443d6251d30927f51847f9"><div class="ttname"><a href="classElemental__Profile.html#af7ee759943443d6251d30927f51847f9">Elemental_Profile::Contains</a></div><div class="ttdeci">bool Contains(const string &amp;name) const</div><div class="ttdoc">Check if element exists in profile.</div><div class="ttdef"><b>Definition</b> <a href="elemental__profile_8cpp_source.html#l00857">elemental_profile.cpp:857</a></div></div>
<div class="ttc" id="aclassInterface_html"><div class="ttname"><a href="classInterface.html">Interface</a></div><div class="ttdef"><b>Definition</b> <a href="interface_8h_source.html#l00025">interface.h:26</a></div></div>
<div class="ttc" id="aclassInterface_html_a24f0b4b925a432fdd21783e280997e9a"><div class="ttname"><a href="classInterface.html#a24f0b4b925a432fdd21783e280997e9a">Interface::lowlimit</a></div><div class="ttdeci">double lowlimit</div><div class="ttdef"><b>Definition</b> <a href="interface_8h_source.html#l00049">interface.h:49</a></div></div>
<div class="ttc" id="aclassInterface_html_a46a0a0162fc808dd547bc10cf24224ee"><div class="ttname"><a href="classInterface.html#a46a0a0162fc808dd547bc10cf24224ee">Interface::operator=</a></div><div class="ttdeci">Interface &amp; operator=(const Interface &amp;intf)</div><div class="ttdef"><b>Definition</b> <a href="interface_8cpp_source.html#l00014">interface.cpp:14</a></div></div>
<div class="ttc" id="aclassInterface_html_a6cec95c20f7c8c8328f7dfc922309749"><div class="ttname"><a href="classInterface.html#a6cec95c20f7c8c8328f7dfc922309749">Interface::XAxisLabel</a></div><div class="ttdeci">QString XAxisLabel() const</div><div class="ttdef"><b>Definition</b> <a href="interface_8h_source.html#l00075">interface.h:75</a></div></div>
<div class="ttc" id="aclassInterface_html_a9543100e7a8dfce3db64dec59d5bef60"><div class="ttname"><a href="classInterface.html#a9543100e7a8dfce3db64dec59d5bef60">Interface::SetXAxisLabel</a></div><div class="ttdeci">bool SetXAxisLabel(const QString &amp;label)</div><div class="ttdef"><b>Definition</b> <a href="interface_8h_source.html#l00077">interface.h:77</a></div></div>
<div class="ttc" id="aclassInterface_html_ac0dc8a4ab6de18b9538d3764eb8bbf5a"><div class="ttname"><a href="classInterface.html#ac0dc8a4ab6de18b9538d3764eb8bbf5a">Interface::YAxisLabel</a></div><div class="ttdeci">QString YAxisLabel() const</div><div class="ttdef"><b>Definition</b> <a href="interface_8h_source.html#l00076">interface.h:76</a></div></div>
<div class="ttc" id="aclassInterface_html_acec157511b980b04f19ca39c97b19054"><div class="ttname"><a href="classInterface.html#acec157511b980b04f19ca39c97b19054">Interface::highlightoutsideoflimit</a></div><div class="ttdeci">bool highlightoutsideoflimit</div><div class="ttdef"><b>Definition</b> <a href="interface_8h_source.html#l00050">interface.h:50</a></div></div>
<div class="ttc" id="aclassInterface_html_afc32c062b437f34324478d35cfeb54b5"><div class="ttname"><a href="classInterface.html#afc32c062b437f34324478d35cfeb54b5">Interface::SetYAxisLabel</a></div><div class="ttdeci">bool SetYAxisLabel(const QString &amp;label)</div><div class="ttdef"><b>Definition</b> <a href="interface_8h_source.html#l00078">interface.h:78</a></div></div>
<div class="ttc" id="aclassInterface_html_afc616e2f2efcfa4bc781498b69384df2"><div class="ttname"><a href="classInterface.html#afc616e2f2efcfa4bc781498b69384df2">Interface::highlimit</a></div><div class="ttdeci">double highlimit</div><div class="ttdef"><b>Definition</b> <a href="interface_8h_source.html#l00049">interface.h:49</a></div></div>
<div class="ttc" id="aclassMultipleLinearRegressionSet_html"><div class="ttname"><a href="classMultipleLinearRegressionSet.html">MultipleLinearRegressionSet</a></div><div class="ttdef"><b>Definition</b> <a href="multiplelinearregressionset_8h_source.html#l00007">multiplelinearregressionset.h:8</a></div></div>
<div class="ttc" id="aclassMultipleLinearRegression_html"><div class="ttname"><a href="classMultipleLinearRegression.html">MultipleLinearRegression</a></div><div class="ttdef"><b>Definition</b> <a href="multiplelinearregression_8h_source.html#l00009">multiplelinearregression.h:10</a></div></div>
<div class="ttc" id="aelemental__profile_8h_html"><div class="ttname"><a href="elemental__profile_8h.html">elemental_profile.h</a></div><div class="ttdoc">Elemental concentration profile for sediment source fingerprinting.</div></div>
<div class="ttc" id="amultiplelinearregression_8h_html_a126d68f6f19dcf3ad6b16e179766a91fa9a932b3cb396238423eb2f33ec17d6aa"><div class="ttname"><a href="multiplelinearregression_8h.html#a126d68f6f19dcf3ad6b16e179766a91fa9a932b3cb396238423eb2f33ec17d6aa">regression_form::linear</a></div><div class="ttdeci">@ linear</div></div>
<div class="ttc" id="aresultitem_8h_html_ae0bada42736b9c6772b26fad4557dbd7afac131120365e920d07c1ef7f062c7b0"><div class="ttname"><a href="resultitem_8h.html#ae0bada42736b9c6772b26fad4557dbd7afac131120365e920d07c1ef7f062c7b0">result_type::mlr</a></div><div class="ttdeci">@ mlr</div></div>
<div class="ttc" id="aselectsampledelegate_8h_html_acfe2faf5163390c1dcc12b16ac4b97b3ab45cffe084dd3d20d928bee85e7b0f21"><div class="ttname"><a href="selectsampledelegate_8h.html#acfe2faf5163390c1dcc12b16ac4b97b3ab45cffe084dd3d20d928bee85e7b0f21">column_type::string</a></div><div class="ttdeci">@ string</div></div>
<div class="ttc" id="astructelement__information_html"><div class="ttname"><a href="structelement__information.html">element_information</a></div><div class="ttdoc">Metadata describing an element's role and properties in analysis.</div><div class="ttdef"><b>Definition</b> <a href="elemental__profile_8h_source.html#l00050">elemental_profile.h:51</a></div></div>
<div class="ttc" id="astructelement__information_html_a5f9e4723fe2c080ca91b31a8f697dd4e"><div class="ttname"><a href="structelement__information.html#a5f9e4723fe2c080ca91b31a8f697dd4e">element_information::Role</a></div><div class="ttdeci">enum element_information::role Role</div></div>
<div class="ttc" id="astructelement__information_html_a927baa115e71066b2964052d16cc474caa8b1c31fc8c4c565d63b478eddb9b172"><div class="ttname"><a href="structelement__information.html#a927baa115e71066b2964052d16cc474caa8b1c31fc8c4c565d63b478eddb9b172">element_information::role::isotope</a></div><div class="ttdeci">@ isotope</div><div class="ttdoc">Isotopic ratio (e.g., 206Pb/207Pb)</div></div>
<div class="ttc" id="astructelement__information_html_a927baa115e71066b2964052d16cc474caea679c8b8d3e2f3ce01d0409a42f68f2"><div class="ttname"><a href="structelement__information.html#a927baa115e71066b2964052d16cc474caea679c8b8d3e2f3ce01d0409a42f68f2">element_information::role::do_not_include</a></div><div class="ttdeci">@ do_not_include</div><div class="ttdoc">Exclude from all analyses.</div></div>
<div class="ttc" id="astructelement__information_html_ac50ec2cd0b5510b23e917db405b2a62d"><div class="ttname"><a href="structelement__information.html#ac50ec2cd0b5510b23e917db405b2a62d">element_information::include_in_analysis</a></div><div class="ttdeci">bool include_in_analysis</div><div class="ttdoc">Whether to include in statistical analyses.</div><div class="ttdef"><b>Definition</b> <a href="elemental__profile_8h_source.html#l00066">elemental_profile.h:66</a></div></div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
